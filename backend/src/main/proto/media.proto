syntax = "proto3";

option java_multiple_files = true;
option java_package = "com.example.mediaservice";

service MediaService {
  rpc UploadVideo (VideoChunk) returns (UploadResponse);
  rpc GetVideoList (Empty) returns (VideoList);
  rpc GetVideo (VideoRequest) returns (VideoResponse);
  rpc GetQueueStatus (Empty) returns (QueueStatus);
}

// Simplified to match ProducerClient.java logic
message VideoChunk {
  string filename = 1;
  string client_id = 2;
  bytes data = 3;
}

message QueueStatus {
  bool is_full = 1;
  int32 current_size = 2;
  int32 max_capacity = 3;
}

message UploadResponse {
  string status = 1; // "SUCCESS", "QUEUED", "DROPPED", "FAILED"
  string message = 2;
  string video_id = 3;
}

message Empty {}

message VideoList {
  repeated VideoInfo videos = 1;
}

message VideoInfo {
  string id = 1;
  string filename = 2;
  string upload_time = 3;
  int64 size = 4; 
  string client_id = 5;
  int64 compressed_size = 6;
}

message VideoRequest {
  string video_id = 1;
}

message VideoResponse {
  string filename = 1;
  bytes data = 2;
  string status = 3;
}